{% extends "base1.html" %}
{% block content %}

<main class="mb-4">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <h2 class="text-center text-white bg-primary py-2 px-4 rounded shadow-sm">Burn-in Test</h2>

        <form action="/burninTest?num=12" method="POST" enctype="multipart/form-data" class="mt-4">
          <h3 id="form-title" class="text-center"></h3>

          <!-- Temperature, Humidity, Dew Point, and Working Date -->
          <div class="row mt-3">
            <div class="col">
              <label for="temperature" class="form-label">Temperature (Â°C)</label>
              <input type="text" name="temperature" id="temperature" class="form-control" required />
            </div>
            <div class="col">
              <label for="humidity" class="form-label">Humidity</label>
              <input type="text" name="humidity" id="humidity" class="form-control" required />
            </div>
            <div class="col">
              <label for="dewPoint" class="form-label">Dew Point</label>
              <input type="text" name="dewPoint" id="dewPoint" class="form-control" required />
            </div>
            <div class="col">
              <label for="workingDate" class="form-label">Working Date</label>
              <input type="date" name="workingDate" id="workingDate" class="form-control" required />
            </div>
          </div>

          <!-- Input Table -->
          <table id="moduleTable" class="table table-bordered text-center mt-4">
            <thead>
              <tr>
                <th>Left</th>
                <th>Right</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <select name="module_id_left[]" required class="form-control">
                    <option value="">Select Module ID</option>
                    {% for module_id in module_ids %}
                    <option value="{{ module_id }}">{{ module_id }}</option>
                    {% endfor %}
                  </select>
                </td>
                <td>
                  <select name="module_id_right[]" required class="form-control">
                    <option value="">Select Module ID</option>
                    {% for module_id in module_ids %}
                    <option value="{{ module_id }}">{{ module_id }}</option>
                    {% endfor %}
                  </select>
                </td>
                <td>
                  <button type="button" class="btn btn-danger deleteRowBtn">Delete</button>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" id="addRowBtn" class="btn btn-secondary">Add Row</button>

          <!-- File Upload Fields -->
          <div class="mt-4">
            <label class="form-label">Upload Files:</label>
            <div class="file-entries">
              <div class="file-row">
                <label for="fileEntry1">Tracker ROOT File:</label>
                <input type="file" id="fileEntry1" name="fileEntry1" class="form-control mb-2">
              </div>
              <div class="file-row">
                <label for="fileEntry2">Tracker Monitor ROOT File:</label>
                <input type="file" id="fileEntry2" name="fileEntry2" class="form-control mb-2">
              </div>
              <div class="file-row">
                <label for="fileEntry3">Press Supply ROOT File:</label>
                <input type="file" id="fileEntry3" name="fileEntry3" class="form-control mb-2">
              </div>
              <div class="file-row">
                <label for="fileEntry4">Burnin Box ROOT File:</label>
                <input type="file" id="fileEntry4" name="fileEntry4" class="form-control mb-2" webkitdirectory>
              </div>
            </div>
          </div>

          <!-- CKEditor Comment Box -->
          <div class="mt-4">
            <label for="comments" class="form-label">Comments</label>
            <textarea id="comments" name="comments" class="form-control"></textarea>
          </div>

          <!-- Submit Button -->
          <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</main>

<script>
  
    document.addEventListener("DOMContentLoaded", function () {
    // Function to add a new row
    document.getElementById("addRowBtn").addEventListener("click", function () {
        const tableBody = document.querySelector("#moduleTable tbody");
        const newRow = document.createElement("tr");

        // Retrieve the first select element and clone its options
        const moduleOptions = document.querySelector('select[name="module_id_left[]"]').innerHTML;

        newRow.innerHTML = `
            <td>
                <select name="module_id_left[]" required class="form-control">${moduleOptions}</select>
            </td>
            <td>
                <select name="module_id_right[]" required class="form-control">${moduleOptions}</select>
            </td>
            <td>
                <button type="button" class="btn btn-danger deleteRowBtn">Delete</button>
            </td>
        `;

        // Append new row to the table
        tableBody.appendChild(newRow);

        // Add event listener to new delete button
        newRow.querySelector(".deleteRowBtn").addEventListener("click", function () {
            newRow.remove();
        });
    });

    // Ensure delete works for existing rows
        document.querySelectorAll(".deleteRowBtn").forEach((btn) => {
            btn.addEventListener("click", function () {
                this.closest("tr").remove();
            });
        });
    });

</script>

  

{% endblock %}
